<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Explosiones Criptos V 1.0</title>
  <style>
    :root{
      --bg:#0b0d12;
      --panel:#111826;
      --panel-2:#0f172a;
      --accent:#22c55e;
      --accent-2:#ef4444;
      --muted:#9db2d8;
      --text:#e6eefc;
      --ok:#22c55e;
      --bad:#ef4444;
      --warn:#f59e0b;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
    }

    html,body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      min-height:100vh;
      overflow-x:hidden;
    }

    /* Contenedor principal */
    .phone-screen{
      background:var(--bg);
      width:100%;
      max-width:800px;
      min-height:100vh;
      overflow-y:auto;
      overflow-x:hidden;
      border-radius:0;
      padding:0;
      box-sizing:border-box;
    }

    /* Contenido principal */
    .wrap, header, .card, .controls{
      max-width:100%;
      overflow-x:hidden;
      box-sizing:border-box;
    }

    .wrap{max-width:100%; margin:0 auto; padding:6%}
    header{
      background:linear-gradient(180deg,#0f1a33 0%, #0b1024 100%);
      border:1px solid #1f2a44; border-radius:var(--radius);
      padding:1% 1% 10%; box-shadow:var(--shadow);
    }

    h1{margin:0; font-size:clamp(1rem, 4vw, 1.3rem); letter-spacing:.2px; text-align:center}
    .sub{color:var(--muted); margin-top:6px; font-size:clamp(0.8rem, 3.5vw, .95rem); text-align:center}

    .controls{display:grid; gap:2%; margin-top:6%; grid-template-columns:1fr}
    .card{background:var(--panel); border:1px solid #1c2742; border-radius:var(--radius); padding:12px; box-shadow:var(--shadow)}
    .title{font-weight:600; margin-bottom:8px; font-size:clamp(0.9rem,3vw,1rem); text-align:center}
    .row{display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:center}
    .pill{background:var(--panel-2); border:1px solid #1d2845; border-radius:12px; padding:6px 10px; color:#9db2d8; font-size:.9rem; display:inline-flex; align-items:center; gap:10px}
    button,.btn{cursor:pointer; border:none; border-radius:12px; padding:10px 14px; background:#18233f; color:#cfe0ff; box-shadow:var(--shadow)}
    .btn-ghost{background:transparent; border:1px solid #263458}
    .btn-ok{background:var(--ok); color:#08210f}
    .btn-small{padding:6px 10px; border-radius:10px; font-size:.9rem}
    .intervalo-box{display:flex; align-items:center; justify-content:center; gap:10px}
    .intervalo{min-width:70px; text-align:center; background:#0e1730; border:1px solid #203058; border-radius:10px; padding:6px 10px; font-weight:700}
    .arrow{width:34px; height:34px; border-radius:10px; display:grid; place-items:center; font-weight:800; background:#0e1730; border:1px solid #203058}
    .slider-wrap input[type=range]{width:100%}

    /* Sin scroll interno */
    .accordion-body, .slider-wrap{overflow-y:hidden !important; overflow-x:hidden !important;}
    .accordion{border:1px solid #203058; border-radius:12px; background:#0e1730}
    .accordion-head{display:flex; align-items:center; justify-content:space-between; padding:12px 14px; cursor:pointer}
    .grid-cryptos{columns:2}
    .grid-cryptos label{display:block; padding:6px 4px; color:#cfe0ff; font-size:.9rem}

    .status{display:flex; align-items:center; gap:10px; flex-wrap:wrap; position:relative; justify-content:center}
    .semaforo{display:flex; gap:15%}
    .dot{width:22px; height:22px; border-radius:50%; background:#2a3458; border:1px solid #3c4a72;}
    .dot.verde{background:#19e27a; border-color:#2f8d5d;}
    .dot.roja{background:#ff5a76; border-color:#a12d42;}

    /* === TABLA RESPONSIVE === */
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10%;
      background:#0f1731;
      border:1px solid #203058;
      border-radius:12px;
      font-size:clamp(0.65rem, 2.2vw, 0.85rem);
      table-layout:fixed;
      word-wrap:break-word;
    }
    thead th{
      background:#0e1730;
      color:#cfe0ff;
      text-align:left;
      padding:clamp(4px, 1vw, 8px);
      border-bottom:1px solid #203058;
      font-size:clamp(0.7rem,2.5vw,0.9rem);
    }
    tbody td{
      padding:clamp(4px,1vw,6px);
      border-bottom:1px solid #1b2a4d;
      color:#dbe6ff;
      text-align:left;
    }
    tbody tr.new{animation:flash 1.2s ease}
    @keyframes flash{0%{background:#0a3b2a}100%{background:transparent}}

    .footer-note{color:#7fa4ff66; font-size:.8rem; margin-top:8px; text-align:center}

    #countdown{
      font-size:0.9rem;
      color:var(--accent);
      background:rgba(25,35,55,0.85);
      padding:4px 10px;
      border-radius:8px;
      border:1px solid #1e3a5f;
      box-shadow:0 0 6px rgba(0,0,0,0.3);
      font-variant-numeric:tabular-nums;
      min-width:48px;
      text-align:center;
    }

    @media (orientation: landscape) {
      .phone-screen{
        max-width:900px;
      }
      table{font-size:clamp(0.6rem,1.3vw,0.9rem);}
      h1{font-size:clamp(1rem,2.2vw,1.4rem);}
    }
  </style>
</head>
<body>
  <div class="phone-screen">
    <div class="wrap">
      <header>
        <h1>Explosiones Criptos V 1.0</h1>
        <div class="sub">Detector en tiempo real de picos bruscos (Binance)</div>

        <div class="controls">
          <!-- Intervalo -->
          <div class="card">
            <div class="title">Intervalo</div>
            <div class="intervalo-box">
              <button class="arrow" id="int-prev">&lt;</button>
              <div class="intervalo" id="intervalo-label">15m</div>
              <button class="arrow" id="int-next">&gt;</button>
            </div>
            <div class="footer-note">Cicla entre: 5m ‚Ä¢ 10m ‚Ä¢ 15m ‚Ä¢ 30m ‚Ä¢ 1h ‚Ä¢ 2h</div>
          </div>

          <!-- Sensibilidad -->
          <div class="card">
            <div class="title">Sensibilidad de explosi√≥n (%)</div>
            <div class="slider-wrap">
              <div class="row" style="justify-content:space-between">
                <div class="pill">M√≠nimo: <span class="val" id="umbral-min-val">15%</span></div>
                <label class="row pill" style="gap:8px;">M√°ximo: <span class="val" id="umbral-max-val">‚àû</span></label>
              </div>
              <input id="umbral-min" type="range" min="0" max="100" step="1" value="15" />
              <div class="row" style="margin-top:8px; align-items:center; gap:8px">
                <input id="sin-limite" type="checkbox" checked />
                <label for="sin-limite" class="pill">Sin l√≠mite superior (‚àû)</label>
              </div>
              <div id="umbral-max-wrap" class="row" style="display:none; margin-top:8px">
                <input id="umbral-max" type="range" min="1" max="100" step="1" value="100" />
              </div>
            </div>
            <div class="footer-note">Se activa una alarma cuando la vela supera el % m√≠nimo.</div>
          </div>

          <!-- Criptomonedas -->
          <div class="card">
            <div class="title">Criptomonedas a rastrear</div>
            <div class="accordion" id="acc-cryptos">
              <div class="accordion-head">
                <div>üìà Seleccionar criptos</div>
                <button class="btn-small btn-ghost" id="acc-toggle">Abrir</button>
              </div>
              <div class="accordion-body" id="acc-body">
                <div class="grid-cryptos" id="crypto-list"></div>
                <div class="row" style="justify-content:flex-end; margin-top:8px">
                  <button class="btn-ok btn-small" id="acc-close">‚úîÔ∏è Listo</button>
                </div>
              </div>
            </div>
            <div class="footer-note">El panel se oculta para ocupar lo m√≠nimo en pantalla.</div>
            <div class="row" style="justify-content:center">
              <button class="btn" id="btn-start">Iniciar</button>
              <button class="btn-ghost" id="btn-stop">Detener</button>
              <button class="btn-ghost" id="btn-clear">Vaciar</button>
              <button class="btn-ghost" id="btn-sonido">üîä ON</button>
            </div>
          </div>
        </div>

        <!-- Estado -->
        <div class="row" style="margin-top:1%; justify-content:center">
          <div class="status">
            <div>Sem√°foro:</div>
            <div class="semaforo">
              <div class="dot" id="led-verde" title="Explosi√≥n alcista"></div>
              <div class="dot" id="led-rojo" title="Explosi√≥n bajista"></div>
            </div>
            <div id="countdown">--</div>üïí
            <div id="status-text" style="color:#9db2d8; font-size:0.85rem; min-height:1.2em;">Preparado para analizar...</div>
          </div>
        </div>
      </header>

      <!-- Registros -->
      <div class="card" style="margin-top:1%">
        <div class="title">Registros de explosiones</div>
        <table>
          <thead>
            <tr>
              <th>Cripto</th>
              <th>Intervalo</th>
              <th>Fecha</th>
              <th>Hora</th>
              <th>% Cambio</th>
              <th>Tipo</th>
              <th>Inicio</th>
              <th>M√°x/M√≠n</th>
              <th>Fin</th>
              <th>Volumen</th>
              <th>Vol. Medio</th>
              <th>Comentario</th>
            </tr>
          </thead>
          <tbody id="tabla-registros"></tbody>
        </table>
        <div class="footer-note">Los eventos se guardan en localStorage para persistencia local.</div>
      </div>
    </div>
  </div>

  <script src="recogerDatos.js" defer></script>
  <script src="procesarExplosiones.js" defer></script>
  <script src="uiExplosiones.js?v=2" defer></script>
</body>
</html>
